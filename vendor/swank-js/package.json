{
  "name": "swank-js",
  "version": "0.0.5",
  "description": "Swank backend for Node.JS and in-browser JavaScript.",
  "keywords": [
    "swank",
    "slime",
    "emacs",
    "repl"
  ],
  "author": {
    "name": "Ivan Shvedunov"
  },
  "contributors": [
    {
      "name": "Robert Krahn"
    },
    {
      "name": "Irakli Gozalishvili",
      "email": "rfobic@gmail.com"
    },
    {
      "name": "Jonathan Arkell",
      "email": "jonnay@jonnay.net"
    }
  ],
  "homepage": "https://github.com/swank-js/swank-js",
  "repository": {
    "type": "git",
    "url": "https://github.com/swank-js/swank-js.git",
    "web": "https://github.com/swank-js/swank-js"
  },
  "bugs": {
    "url": "https://github.com/swank-js/swank-js/issues/"
  },
  "main": "./swank.js",
  "bin": {
    "swank-js": "./swank.js"
  },
  "dependencies": {
    "socket.io": ">=0.9",
    "socket.io-client": ">=0.9"
  },
  "scripts": {
    "swank": "node ./swank.js"
  },
  "licenses": [
    {
      "type": "X11-style",
      "url": "https://raw.github.com/swank-js/swank-js/master/LICENSE"
    }
  ],
  "readme": "swank-js\n========\n\nNOTE: the official repo is at [[https://github.com/swank-js/swank-js]].\n\nswank-js provides [SLIME](http://common-lisp.net/project/slime/) REPL\nand other development tools for in-browser JavaScript and\n[Node.JS](http://nodejs.org). It consists of SWANK backend and\naccompanying SLIME contrib. [Socket.IO](http://socket.io/) is used to\ncommunicate with wide range of web browsers.\n\nRequest for Contributors\n------------------------\n\nA lot of the contributors of this project are strapped for time, and \nwe could use some more. \n\nPlease see: https://github.com/swank-js/swank-js/issues/52\n\nMotivation\n----------\n\nFrom my experience an ability to use REPL for JavaScript debugging and\ninteractive development is very helpful when developing Web\napplications. Previously I was using a heavily patched\n[MozRepl](https://github.com/bard/mozrepl/wiki/) version that was\nadapted for in-browser JavaScript. Primary downsides of that approach\nwere extreme instability of communication between Emacs and the\nbrowser, the lack of cross-browser support and the lack of good RPC\nbetween Emacs and JS that can be used to develop some handy\nextensions.\n\nI knew there exists [slime-proxy](https://github.com/3b/slime-proxy)\nproject that provides such functionality for\n[Parenscript](http://common-lisp.net/project/parenscript/). The\nproblem is that most of us including myself can't use Lisp all the\ntime and a lot of code needs to be developed using languages like\nplain JavaScript (as opposed to Parenscript), Python and so on. My\nfirst thought was to adapt slime-proxy for use with plain JS, but then\nI decided to roll my own SWANK backend using Node.JS. I wanted to find\nout what this buzz around Node.JS is about and perhaps steal an\nidea or two from there for use in my Lisp projects. Another reason was\navailability of [Socket.IO](http://socket.io/) and an example of\n[tiny http server proxy](http://www.catonmat.net/http-proxy-in-nodejs).\n\nSome people may prefer Firebug or built-in browser development tools\nto Emacs-based development, but for example in case of mobile browsers\nyou don't have much choice. At some point I did try swank-js with an\ncolleague's iPhone and it worked, which is not too unexpected given\nthat Socket.IO has good cross-browser support.\n\nStatus\n------\n\nAs of now swank-js provides REPL with an ability to work with multiple\nbrowser connections, supports dynamic updates of JavaScript code using\nC-c C-c / C-M-x, provides debug output function and an ability to\nreload web pages in the browser or refresh their CSS using Emacs\ncommands.\n\nMany aspects of full-fledged SWANK backends aren't implemented yet,\nthere's no debugger/completion/autodoc and so on, but as I plan to use\nswank-js a lot in future there's a good chance many of these features\nwill be eventually added.\n\nInstallation\n------------\n\n1. Install [Node.JS](http://nodejs.org) and [npm](http://npmjs.org/)\n\n2. Install swank-js from npm:\n\n        npm install -g swank-js\n\n3. Get recent [SLIME](http://common-lisp.net/project/slime/) from its CVS\nor the [git mirror](http://git.boinkor.net/gitweb/slime.git). The backend\nwas verified to work with SLIME 2012-02-12, it may or may not work with\nother versions, but note that breaking change in the protocol was introduced\nin SLIME 2011-11-27.\n\n4. Make sure you have latest [js2-mode](http://code.google.com/p/js2-mode/).\nAdd it to your .emacs:\n\n        (add-to-list 'load-path \"/path/to/js2-mode/directory\")\n        (autoload 'js2-mode \"js2-mode\" nil t)\n        (add-to-list 'auto-mode-alist '(\"\\\\.js$\" . js2-mode))\n\n5. Create symbolic link to slime-js.el in the contrib subdirectory of\nSLIME project.\n\n6. Install [js2-mode](http://code.google.com/p/js2-mode/) into emacs from\n   http://tromey.com/elpa/\n\n7. In your .emacs, add the following lines (you may use other key for\nslime-js-reload; also, if you're already using SLIME, just add slime-js\nto the list of contribs, otherwise adjust the load-path item):\n\n        (global-set-key [f5] 'slime-js-reload)\n        (add-hook 'js2-mode-hook\n                  (lambda ()\n                    (slime-js-minor-mode 1)))\n\n8. If you're using CSS mode, you may want to add the following lines too:\n\n        (add-hook 'css-mode-hook\n                  (lambda ()\n                    (define-key css-mode-map \"\\M-\\C-x\" 'slime-js-refresh-css)\n                    (define-key css-mode-map \"\\C-c\\C-r\" 'slime-js-embed-css)))\n\nUsage\n-----\n\nIf you want to use swank from the node project just add following to your\npackage.json file:\n\n        \"devDependencies\": {\n          \"swank-js\": \">=0.0.1\"\n        },\n        \"scripts\": {\n          \"swank\": \"node node_modules/swank-js\"\n        }\n\nOnce this is done you should be able to run up a swank for this project by\nrunning:\n\n        npm run swank\n\nAlternatively you can install swank-js globally by running:\n\n        npm install -g swank-js\n\nOnce installed you could run it from you project directory:\n\n        swank-js\n\nMake SLIME connect to the backend using `M-x slime-connect` and\nspecifying `localhost` and port `4005`. You will see REPL buffer\nwith the following prompt:\n\n    NODE>\n\nThis means that you're currently talking to Node.JS. You may play\naround with it by running some JavaScript expressions.\n\nIf you get warning about SLIME version mismatch, you may make it\ndisappear until the next SLIME upgrade by typing *,js-slime-version*\nat the REPL and entering your SLIME version (e.g. 2010-11-13).\n\n### Connecting to a web browser ###\n\nPoint your web browser to\n\n    http://localhost:8009/swank-js/test.html\nYou will see the following message appear in the REPL (browser name\nand version may differ):\n\n    Remote attached: (browser) Firefox3.6:127.0.0.1\n\nThis means that the browser is now connected. Several browsers can\nconnect simultaneously and you can switch between them and Node.JS\nREPL using *,select-remote* REPL shortcut. To use it, press ','\n(comma) and type *select-remote* (completion is supported). You will\nsee \"Remote:\" prompt. Press TAB to see completions. Select your\nbrowser in the list by typing its name or clicking on the\ncompletion. The following message will appear:\n\n    NODE>\n    Remote selected: (browser) Firefox3.6:127.0.0.1\n    FIREFOX-3.6>\n\nAfter that, you can interactively evaluate expressions in your\nbrowser. To go back to Node.JS repl, switch back to node.js/direct\nremote.\n\n    FIREFOX-3.6> document.body.nodeName\n    BODY\n    FIREFOX-3.6> alert(\"test!\")\n    FIREFOX-3.6>\n\nWhen working with browser, you may use F5 to reload the page. swank-js\nconnection with browser is lost in this case, but to solve this\nproblem you may use *,sticky-select-remote* instead of\n*,select-remote*. This way swank-js will remember your selection and\nautomagically attach to the browser whenever it connects. If you press\nF5 after using *,sticky-select-remote*, you will see that browser\nbriefly disconnects but then connects again:\n\n    Remote detached: (browser) Firefox3.6:127.0.0.1\n    FIREFOX-3.6>\n    Remote selected (auto): (direct) node.js\n    Remote attached: (browser) Firefox3.6:127.0.0.1\n    NODE>\n    Remote selected (auto): (browser) Firefox3.6:127.0.0.1\n    FIREFOX-3.6>\n\nThe sticky remote selection is saved in the config file, ~/.swankjsrc,\nso you don't need to do *,sticky-select-remote* after restarting the\nbrowser.\n\n\n### Connecting to a remote page ###\n\nNow, let's try to make it work with an actual site. swank-js acts as a\nproxy between your browser and the site so it can inject necessary\nscript tags into HTML pages and avoid cross-domain HTTP request\nproblems. Let's point it to [reddit](http://www.reddit.com). Type\n*,target-url* and then *http://www.reddit.com* (www. part is\nimportant, otherwise it will redirect to www.reddit.com skipping the\nproxy). Point your browser to http://localhost:8009, you'll see reddit\nfrontpage load. If you didn't do *,select-remote* or\n*,sticky-select-remote* yet do it now and select your browser from the\nlist of remotes. Now you can execute JavaScript in the context of\nreddit:\n\n    FIREFOX-3.6> $(\".sitetable a.title\").map(function(n) { return (n + 1) + \". \" + $(this).text(); }).get().join(\"\\n\")\n    1. Wikileaks currently under a mass DDOS attack\n    2. Munich University - Jealous\n    ...\n\nLet's make a function from it. Create a file test.js somewhere and\nmake sure it uses js2-mode (if it doesn't, switch it to js2-mode using\nM-x js2-mode). Type the following there:\n\n    function listRedditTitles () {\n      $(\".sitetable a.title\").map(\n        function (n) {\n          SwankJS.output((n + 1) + \". \" + $(this).text() + \"\\n\");\n        }).get().join(\"\\n\");\n    }\n\nNote SwankJS.output() function being used there. It allows you to send\ndebug print to SLIME REPL.\n\nMove the point somewhere into the middle of the listRedditTitles() function\nand press C-M-x. Now you may try it out in the REPL:\n\n    FIREFOX-3.6> listRedditTitles()\n    1. Wikileaks currently under a mass DDOS attack\n    2. Munich University - Jealous\n    ...\n\nYou may edit the function definition and update it using C-M-x any\nnumber of times.\n\n\n### Hacking CSS ###\n\n#### By updating a file ####\n\nNow let's try some CSS hacking. Create a directory named zzz and start\na Web server in it from your command prompt:\n\n    $ mkdir zzz && cd zzz && python -mSimpleHTTPServer\n\nCreate a file named a.css there and make sure it uses css-mode (like\nwith js2-mode, you can force it with M-x css-mode). Add some CSS rules\nto this file:\n\n    body {\n        background: green;\n    }\n\nNow let's add the stylesheet to the reddit page:\n\n    FIREFOX-3.6> $('head').append('<link rel=\"stylesheet\" href=\"http://localhost:8000/a.css\" type=\"text/css\" />');\n    [object Object]\n\nYou will see some parts of the page become green. Now, change green to\nblue in the CSS file and press C-M-x (it will save the file\nautomatically):\n\n    body {\n        background: blue;\n    }\n\nYou will see the page become blue, maybe after some flickering as all\nCSS used on the page is reloaded. This way you may update CSS in an\nAJAX application without reloading the page, which is often rather\nhandy. Unlike editing CSS in Firebug in case when you're editing CSS\nof your own application changes will not disappear upon page reload\n(with reddit page you'll have to readd the stylesheet).\n\n\n#### By embedding CSS ####\n\nAlternatively to just try out a snippet of CSS you can select some CSS code and hit `C-c C-r`. This will send the code snippet (or the content of the whole buffer) to the browser and embed it inside a style element.\n\nTo remove the embedded CSS run the command with a prefix `C-u C-c C-r`.\n\n\n### Embedding swank-js in a page ###\n\nThis is useful for automatically connecting to a web page you develop\nlocally without using the *,target-url* command and without changing\nthe document URL for that page. When `node swank.js` is running embed\n\n    <script type=\"text/javascript\" src=\"http://localhost:8009/swank-js/swank-js-inject.js\"></script>\n\nand you are ready to go!\n\n### swank-js as a bookmarklet ###\n\nYou can bookmark\n<a href=\"javascript:(function(d)%7Bwindow.swank_server%3D%27http%3A%2F%2Flocalhost%3A8009%2F%27%3Bif(!d.getElementById(%27swank-js-inj%27))%7Bvar%20h%3Dd.getElementsByTagName(%27head%27)%5B0%5D%2Cs%3Dd.createElement(%27script%27)%3Bs.id%3D%27swank-js-inj%27%3Bs.type%3D%27text%2Fjavascript%27%3Bs.src%3Dswank_server%2B%27swank-js%2Fswank-js-inject.js%27%3Bh.appendChild(s)%3B%7D%7D)(document)%3B\">\nswank connect</a> /\n<a\nhref=\"javascript:(function()%7BSwankJS.disconnect()%3B%7D)()%3B\">swank\ndisconnect</a>\nlinks and use them on any page you'd like to play with.\n\n### swank-js from another node.js process ###\n\nWhen installed globally (`npm install -g swank-js`) you can connect another node.js process to the swank-js node process via\n\n```js\nrequire(\"swank-js/client/node\").setupNodeJSClient();\n```\n\nOptionally you can pass in *swank_server_host* and *swank_server_port* as arguments to the `setupNodeJSClient` call.\n\nTroubleshooting\n---------------\n\nI've noticed that flashsocket Socket.IO transport does exhibit some\ninstability. You may want to try other transports by changing the\nsocketio cookie, e.g.:\n\n    document.cookie = \"socketio=xhr-polling\"\n\nBe careful not to lose connection to the browser though especially in\ncase of REPL-less browser like IE6/7 or you'll have to type something\nlike\n\n    javascript:void(document.cookie = \"socketio=flashsocket\")\n\nin the address bar.\n\nIn case of IE, increasing the maximum number of HTTP connections may\nhelp with non-Flash transports, although I didn't try it yet. To do it\nadd DWORD value MaxConnectionsPer1_0Server to the following registry\nkey:\n\n    HKEY\\_CURRENT\\_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\n\nLicense\n-------\n\nswank-js is distributed under X11-style license. See LICENSE file.\n",
  "readmeFilename": "README.md",
  "_id": "swank-js@0.0.5",
  "dist": {
    "shasum": "7fd7a7b92f8bc916dd9fbb891b65cbe06c00f7ea"
  },
  "_from": "swank-js@",
  "_resolved": "https://registry.npmjs.org/swank-js/-/swank-js-0.0.5.tgz"
}
